1 проход

выделяем память под line1
(его чистим в main)

work_with_file

фришим line1
выделяем новый line2

зашли в if (\n)

1! 
фришим line2
выделяем новый line3
2!
выделяем новый итер1

в main фришим line3

2й проход
выделяем новый line4

 work_with_iter

 если \n не встретили , то
фришим line4
выделяем новый line5
переносим туда весь итер1

вышли в get_next_line
почистили iter1

work_with_file

все тоже самое
лайн -1 +1
итер +1